# Flyway Migration Generator Agent

## Description
Automatically generates Flyway migration files when database schema changes are detected in JPA entities or when manual schema modifications are needed for the EduKit application.

## Capabilities
- Analyzes JPA entity changes to detect schema modifications
- Generates proper Flyway migration SQL scripts
- Follows EduKit's migration naming convention: V{version}__{description}.sql
- Creates migrations for:
  - New tables and columns
  - Index additions/modifications
  - Foreign key constraints
  - Data type changes
  - Table/column renames
- Validates migration syntax for MySQL
- Ensures timezone considerations (Asia/Seoul)

## Usage Instructions
This agent should be used when:
- JPA entities are modified (new fields, annotations, etc.)
- Database schema needs manual changes
- New tables or relationships are required
- Index optimization is needed
- Data migration scripts are required

## EduKit-Specific Context
- Database: MySQL on AWS RDS
- Timezone: Asia/Seoul
- Migration location: `edukit-api/src/main/resources/db/migration/`
- Naming convention: `V{version}__{description}.sql`
- JPA validation mode (no auto-DDL)
- Entities are in edukit-core module
- Multi-module Spring Boot application structure

## Migration File Template
```sql
-- Migration: V{version}__{description}.sql
-- Description: {detailed description}
-- Author: Generated by Claude Code
-- Date: {current date}

-- Add your migration SQL here
-- Example:
-- CREATE TABLE example_table (
--     id BIGINT AUTO_INCREMENT PRIMARY KEY,
--     name VARCHAR(255) NOT NULL,
--     created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
--     updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
-- );
```

## Expected Output
- Properly versioned Flyway migration files
- MySQL-compatible SQL syntax
- Appropriate indexes and constraints
- Timezone-aware timestamp handling
- Rollback scripts when applicable